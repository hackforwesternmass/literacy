{% load tabindex from tag_extras %}
{% load currency from tag_extras %}
{% load bool_yn from tag_extras %}
{% include "topmatter.html" %}
{% load widget_tweaks %}

<div id="row">

    <form method="post" action="" role="form" class="col-md-6 col-md-offset-2">
        {% csrf_token %}
        {{ occ_formset.management_form }}

        {% if not hide_contact_form %}
        <h3>Contact Information</h3>
        {% include "contact-form.html" %}
        {% endif %}

        <h3>Career Information</h3>

        <p>What field do you work in?</p>
        {{ occ_formset.forms.0.industry |add_class:"form-control" }}<br/>
        Job Title
        {{ occ_formset.forms.0.job_title |add_class:"form-control" }}<br/>
        {{ occ_formset.forms.0.id |add_class:"form-control" }}
        <a id="add-more-occ-link">Add more occupations</a>

        <table id="more-occ-div" style="display: none">
            <thead>
            <tr>
                <th>Industry</th>
                <th>Job Title</th>
                <!--<th>Start Date</th>
                <th>End Date</th>-->
            </tr>
            </thead>
            <tbody>
            {% for occ_form in occ_formset|slice:"1:" %}
            {{ occ_form.id }}
            <tr>
                <td>{{ occ_form.industry|add_class:"form-control" }}</td>
                <td>{{ occ_form.job_title|add_class:"form-control" }}</td>
                <!--<td>{{ occ_form.start_date |add_class:"form-control" }}</td>
                <td>{{ occ_form.end_date |add_class:"form-control" }}</td> -->
            </tr>
            {% endfor %}
            </tbody>
        </table>


        <h3 style="margin-top: 50px;">Volunteer Information</h3>

        <p>How would you like to volunteer?</p>

        {{ help_formset.management_form }}
        {% for help_form in help_formset %}
        {{ help_form.affirmative |add_class:"form-control" }}
        {{ help_form.help_type.as_hidden }}
        {{ help_form.id |add_class:"form-control" }}
        {{ help_form.instance.help_type.description }}
        {% endfor %}

        {{ site_formset.management_form }}
        <div class="checkbox">
            <label>
                <input type="checkbox" data-bind="checked: willvisit"> Visit classes as a guest speaker
            </label>
        </div>

        <div style="margin: 10px" data-bind="visible: willvisit">
            Which sites could you visit?
            <ul style="list-style-type: none; margin-left: 30px;">
                {% for site_form in site_formset %}
                {{ site_form.site.as_hidden }}
                {{ site_form.id }}
                <li>{{ site_form.affirmative }} {{ site_form.instance.site.name }}</li>
                {% endfor %}
                <ul>
        </div>
        <button type="submit" class="btn btn-primary">Submit</button>
</form>

<script type="text/javascript">
    $(document).ready(function() {
        {% if anchor %}
            location.hash = "#" + {{ anchor }}
        {% endif %}
        
        $("#add-more-occ-link").click(function(e) {
            e.preventDefault();
            $("#more-occ-div").show();
            $("#add-more-occ-link").hide();
        });

        var viewModel = {
            willvisit: ko.observable(false) // Message initially visible
        };
        viewModel.willvisit.subscribe(function(oldValue) {
            if(!oldValue) {
                window.scrollTo(0,document.body.scrollHeight);
            }
        }, null, "beforeChange");
        ko.applyBindings(viewModel);
    });











</script>

{% include "footer.html" %}

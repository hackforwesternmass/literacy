{% load tabindex from tag_extras %}
{% load currency from tag_extras %}
{% load bool_yn from tag_extras %}
{% include "topmatter.html" %}
{% load widget_tweaks %}

<form method="post" action="" role="form">
    {% csrf_token %}
    <div class="right">
        {% if not hide_contact_form %}
            <h3>Contact Information</h3>
            <hr>
            <a id="contact"></a>
            {{ vol_form.non_field_errors }}
            <label for="id_first_name">First Name</label>
            {{ vol_form.first_name|add_class:"form-control"  }}
            <label for="id_last_name">Last Name</label>
            {{ vol_form.last_name|add_class:"form-control"  }}
        {% endif %}


        <h3 style="margin-top: 50px;">Career Information</h3>
        <hr>
        <a id="career"></a>
        {{ occ_formset.management_form }}

        What field do you work in?
        {{ occ_formset.forms.0.industry |add_class:"form-control" }}<br />
        Job Title
        {{ occ_formset.forms.0.job_title |add_class:"form-control" }}<br />
        {{ occ_formset.forms.0.id |add_class:"form-control" }}
        <a id="add-more-occ-link">Add more occupations</a>
        <div id="more-occ-div" style="display: none">
        <table>
            <thead>
                <tr>
                    <th>Industry</th>
                    <th>Job Title</th>
                    <!--<th>Start Date</th>
                    <th>End Date</th>-->
                </tr>
            </thead>
            <tbody>
                {% for occ_form in occ_formset|slice:"1:" %}
                    {{ occ_form.id }}
                    <tr>
                        <td>{{ occ_form.industry|add_class:"form-control"  }}</td>
                        <td>{{ occ_form.job_title|add_class:"form-control"  }}</td>
                        <!--<td>{{ occ_form.start_date |add_class:"form-control" }}</td>
                        <td>{{ occ_form.end_date |add_class:"form-control" }}</td> -->
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        </div>


        <h3 style="margin-top: 50px;">Volunteer Information</h3>
        <hr>
        How would you like to volunteer?<br />
        <a id="volunteer">&nbsp;</a>
        {{ help_formset.management_form }}
        {% for help_form in help_formset %}
            {{ help_form.affirmative |add_class:"form-control" }}
            {{ help_form.help_type.as_hidden }}
            {{ help_form.id |add_class:"form-control" }}
            {{ help_form.instance.help_type.description }}
            <br />
        {% endfor %}

        {{ site_formset.management_form }}
        <input type="checkbox" data-bind="checked: willvisit">Visit classes as a guest speaker</input>
        <br />
        <div style="margin: 10px" data-bind="visible: willvisit">
        Which sites could you visit?
        <ul style="list-style-type: none; margin-left: 30px;">
        {% for site_form in site_formset %}
            {{ site_form.site.as_hidden }}
            {{ site_form.id  }}
            <li>{{ site_form.affirmative }} {{ site_form.instance.site.name }}</li>
        {% endfor %}
        <ul>
        </div>
        <input type="submit"/>
    </div>
</form>
<div style="margin: 100px;"></div>

<script type="text/javascript">
    $(document).ready(function() {
        {% if anchor %}
            location.hash = "#" + {{ anchor }}
        {% endif %}
        
        $("#add-more-occ-link").click(function(e) {
            e.preventDefault();
            $("#more-occ-div").show();
            $("#add-more-occ-link").hide();
        });

        var viewModel = {
            willvisit: ko.observable(false) // Message initially visible
        };
        viewModel.willvisit.subscribe(function(oldValue) {
            if(!oldValue) {
                window.scrollTo(0,document.body.scrollHeight);
            }
        }, null, "beforeChange");
        ko.applyBindings(viewModel);
    });
</script>

{% include "footer.html" %}
